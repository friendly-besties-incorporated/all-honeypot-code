# Generated by iptables-save v1.8.4 on Tue Oct 11 13:42:29 2022
*mangle
:PREROUTING ACCEPT [656:59356]
:INPUT ACCEPT [656:59356]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [576:83192]
:POSTROUTING ACCEPT [576:83192]
COMMIT
# Completed on Tue Oct 11 13:42:29 2022
# Generated by iptables-save v1.8.4 on Tue Oct 11 13:42:29 2022
*nat
:PREROUTING ACCEPT [38:6236]
:INPUT ACCEPT [3:172]
:OUTPUT ACCEPT [130:10390]
:POSTROUTING ACCEPT [130:10390]
-A POSTROUTING -s 10.0.3.0/24 ! -d 10.0.3.0/24 -j MASQUERADE
COMMIT
# Completed on Tue Oct 11 13:42:29 2022
# Generated by iptables-save v1.8.4 on Tue Oct 11 13:42:29 2022
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [576:83192]
:tcp_flood - [0:0]
:udp_flood - [0:0]
-A INPUT -i lxcbr0 -p tcp -m tcp --dport 53 -m comment --comment "Container Network DNS TCP" -j ACCEPT
-A INPUT -i lxcbr0 -p udp -m udp --dport 53 -m comment --comment "Container Network DNS UDP" -j ACCEPT
-A INPUT -i lxcbr0 -p tcp -m tcp --dport 67 -m comment --comment "Container Network DHCP TCP" -j ACCEPT
-A INPUT -i lxcbr0 -p udp -m udp --dport 67 -m comment --comment "Container Network DHCP UDP" -j ACCEPT
-A INPUT -i lo -m comment --comment "Allow local loopback" -j ACCEPT
-A INPUT -s 172.30.0.0/16 -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT
-A INPUT -s 10.255.0.0/16 -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT
-A INPUT -s 192.168.11.0/24 -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT
-A INPUT -d 10.0.3.1/32 -p tcp -m tcp ! --dport 22 -m comment --comment "Allow connections to the host for MITM" -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -m comment --comment "Allow related/established connections" -j ACCEPT
-A FORWARD -m state --state INVALID -m comment --comment "Drop invalid connections" -j DROP
-A FORWARD -m state --state RELATED,ESTABLISHED -m comment --comment "Allow existing connections" -j ACCEPT
-A FORWARD -s 10.0.3.0/24 -p tcp -j tcp_flood
-A FORWARD -s 10.0.3.0/24 -p udp -j udp_flood
-A FORWARD -s 10.0.3.1/32 -d 10.0.3.0/24 -i lxcbr0 -o lxcbr0 -m comment --comment "Accept connection from host to honeypots" -j ACCEPT
-A FORWARD -s 10.0.3.0/24 -d 10.0.3.1/32 -i lxcbr0 -o lxcbr0 -m comment --comment "Accept connection from honeypots to host" -j ACCEPT
-A FORWARD -s 10.0.3.0/24 -d 10.0.3.0/24 -i lxcbr0 -o lxcbr0 -m comment --comment "Drop connection between honeypots" -j DROP
-A FORWARD -o lxcbr0 -m comment --comment "Forward Container traffic" -j ACCEPT
-A FORWARD -i lxcbr0 -m comment --comment "Forward Container traffic" -j ACCEPT
-A FORWARD -d 10.0.3.0/24 -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT
-A FORWARD -d 10.0.3.0/24 -p tcp -m tcp --dport 80 -m state --state NEW -j ACCEPT
-A FORWARD -d 10.0.3.0/24 -p tcp -m tcp --dport 443 -m state --state NEW -j ACCEPT-A FORWARD -p icmp -m icmp --icmp-type any -m comment --comment "Allow ICMP (Ping)" -j ACCEPT
-A FORWARD -s 10.0.3.0/24 -m comment --comment "Allow all other honeypot outgoing" -j ACCEPT
-A tcp_flood -m hashlimit --hashlimit-upto 1/sec --hashlimit-burst 10 --hashlimit-mode srcip --hashlimit-name TCP_FLOOD --hashlimit-htable-expire 60000 -m state --state NEW -j RETURN
-A tcp_flood -j DROP
-A udp_flood -m hashlimit --hashlimit-upto 1/sec --hashlimit-burst 10 --hashlimit-mode srcip --hashlimit-name UDP_FLOOD --hashlimit-htable-expire 60000 -j RETURN
-A udp_flood -j DROP
COMMIT
# Completed on Tue Oct 11 13:42:29 2022